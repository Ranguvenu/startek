/**
 * Handle selection changes and actions on the competency tree.
 *
 * @module     local_competency
 * @package    local_competency
 * @copyright  2018 hemalathacarun <hemalatha@eabyas.in>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_competency/advancedview_courselist",["jquery","core/url","core/templates","core/notification","core/str","core/ajax","local_competency/menubar"],(function($,url,templates,notification,str,ajax,menubar){var advancedviewCourselist=function(){self._courseid="",self._competencyid="",self._treeModel,self._selectedCompetencyId=null};return advancedviewCourselist.prototype._getajaxCourses=function(evt,params){var node=params.selected,id=$(node).data("id"),btn=$('[data-region="competencyactions"] [data-action="add"]'),actionMenu=$('[data-region="competencyactionsmenu"]'),selectedTitle=$('[data-region="selected-competency"]'),level=0,sublevel=1;if(menubar.closeAll(),void 0===id)$('[data-region="competencyinfo"]').html(node.clone().children().remove().end().text()),$('[data-region="competencyactions"]').data("competency",null),actionMenu.hide();else{var competency=self._treeModel.getCompetency(id);sublevel=(level=self._treeModel.getCompetencyLevel(id))+1,actionMenu.show(),$('[data-region="competencyactions"]').data("competency",competency),AdvancedUserCompentencyView(competency,3),triggerCompetencyViewedEvent(competency)}return strSelectedTaxonomy(level).then((function(str){selectedTitle.text(str)})).catch(notification.exception),strAddTaxonomy(sublevel).then((function(str){btn.show().find('[data-region="term"]').text(str)})).catch(notification.exception),evt.preventDefault(),!1},advancedviewCourselist.prototype._selectionChanged=function(evt,params){var node=params.selected,id=$(node).data("id"),actionMenu=($('[data-region="competencyactions"] [data-action="add"]'),$('[data-region="competencyactionsmenu"]'));$('[data-region="selected-competency"]');if(menubar.closeAll(),void 0===id)console.log("here "),$('[data-region="competencyinfo"]').html(node.clone().children().remove().end().text()),$('[data-region="competencyactions"]').data("competency",null),actionMenu.hide();else{var competency=self._treeModel.getCompetency(id);self._treeModel.getCompetencyLevel(id)+1,actionMenu.show(),$('[data-region="competencyactions"]').data("competency",competency),advancedviewCourselist.prototype._courselistview(competency),advancedviewCourselist.prototype._triggerCompetencyViewedEvent(competency)}return evt.preventDefault(),!1},advancedviewCourselist.prototype._courselistview=function(competency){$('[data-region="courseactivitiesview'+competency.competencyframeworkid+'"]').hide(),ajax.call([{methodname:"local_competency_data_for_advancedview_of_courselist",args:{competencyid:competency.id}}])[0].done((function(context){context.competencies=$.parseJSON(context.competencies),templates.render("local_competency/advancedview_of_courselist",context).then((function(html,js){templates.render("local_competency/loading",{}),$('[data-region="competencyinfo'+competency.competencyframeworkid+'"]').replaceWith(html),$('[data-region="courselistview'+competency.competencyframeworkid+'"]').replaceWith(html)})).fail(notification.exception)})).fail(notification.exception)},advancedviewCourselist.prototype._courseactvitiesview=function(){var competency=self._treeModel.getCompetency(self._competencyid);$('[data-region="courseactivitiesview'+competency.competencyframeworkid+'"]').show(),ajax.call([{methodname:"local_competency_data_for_advancedview_of_usercompetency",args:{competencyid:self._competencyid,courseid:self._courseid}}])[0].done((function(context){context.competency_assignedcmodules=$.parseJSON(context.competency_assignedcmodules),templates.render("local_competency/advancedview_of_usercompetency",context).then((function(html,js){templates.render("local_competency/loading",{});var competency=self._treeModel.getCompetency(self._competencyid);$('[data-region="competencyinfo'+competency.competencyframeworkid+'"]').replaceWith(html),$('[data-region="courseactivitiesview'+competency.competencyframeworkid+'"]').replaceWith(html)})).fail(notification.exception)})).fail(notification.exception)},advancedviewCourselist.prototype._triggerCompetencyViewedEvent=function(competency){competency.id!==self._selectedCompetencyId&&(self._selectedCompetencyId=competency.id,ajax.call([{methodname:"core_competency_competency_viewed",args:{id:competency.id}}]))},advancedviewCourselist.prototype._setter=function(filter,filter_text){return self._filter=filter,self._filter_text=filter_text,"inprogress"==self._filter&&(self._template="block_userdashboard/elearning_courses_innercontent",self._targetSelector="#elearning_inprogress"),"completed"==self._filter&&(self._template="block_userdashboard/elearning_courses_innercontent",self._targetSelector="#elearning_completed"),"menu"==self._filter&&(self._template="block_userdashboard/userdashboard_courses",self._targetSelector="#elearning_inprogress"),advancedviewCourselist.prototype._getajaxCourses()},advancedviewCourselist._callcourseview=function(currentselector,treeModel){self._treeModel=treeModel,$(currentselector).on("selectionchanged",advancedviewCourselist.prototype._selectionChanged)},advancedviewCourselist._callactivities=function(competencyid,competencycourseid){self._courseid=competencycourseid,self._competencyid=competencyid,advancedviewCourselist.prototype._courseactvitiesview()},advancedviewCourselist}));

//# sourceMappingURL=advancedview_courselist.min.js.map