{"version":3,"file":"courses.min.js","sources":["../src/courses.js"],"sourcesContent":["define([\n    'local_courses/jquery.dataTables',\n    'jquery','core/str','core/modal_factory', 'core/ajax'\n], function(DataTable, $,Str,ModalFactory, Ajax){\n    return courses = {\n        load : function() {\n        },\n        usersdatatable : function(args) {\n            console.log(args);\n            params = [];\n            params.action = args.action;\n            params.courseid = args.courseid;\n            params.moduletype = args.moduletype;\n\t\t\tStr.get_strings([{\n                key: 'search',\n                component: 'local_courses'\n            },\n            {\n                key: 'no_users_enrolled',\n                component: 'local_courses'\n            }]).then(function(s) {\n                var oTable = $('#course_users').dataTable({\n                    'bInfo': false,\n                    'processing': true,\n                    'serverSide': true,\n                    'ordering': false,\n                    'ajax': {\n                        \"type\": \"POST\",\n                        \"url\": M.cfg.wwwroot + '/local/courses/ajax.php',\n                        \"data\": params\n                    },\n                    \"bLengthChange\": false,\n                    \"language\": {\n                        \"paginate\": {\n                            \"next\": \">\",\n                            \"previous\": \"<\"\n                        },\n                        'processing': '<img src='+M.cfg.wwwroot + '/local/ajax-loader.svg>'\n                    },\n                    \"oLanguage\": {\n                      \"sSearch\" : s[0],\n        \t\t\t  \"sZeroRecords\": s[1]\n                    },\n                });\n\t\t\t});\n        },\n        deleteuser: function(element) {\n            var enrollmentid = element.userid;\n            // console.log(element);\n            return Str.get_strings([{\n                key: 'deleteuser',\n                component: 'local_courses'\n            }, {\n                key: 'confirmdelete',\n                component: 'local_courses'\n            }]).then(function(s) {\n                ModalFactory.create({\n                    title: s[0],\n                    type: ModalFactory.types.DEFAULT,\n                    body: s[1],\n                    footer: '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">'+M.util.get_string(\"yes\", \"moodle\")+'</button>&nbsp;' +\n                    '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">'+M.util.get_string(\"no\", \"moodle\")+'</button>'\n                }).done(function(modal) {\n                    this.modal = modal;\n                    modal.getRoot().find('[data-action=\"save\"]').on('click', function() {\n                        window.location.href ='enrolledusers.php?id='+element.id+'&ue='+element.userid+'&confirm=1&sesskey=' + M.cfg.sesskey;\n                    }.bind(this));\n                    modal.getFooter().find('[data-action=\"cancel\"]').on('click', function() {\n                        modal.setBody('');\n                        modal.hide();\n                    });\n                    modal.show();\n                }.bind(this));\n            }.bind(this));\n        },\n        enrollUsers: function (args) {\n            // console.log(args);return;\n            return Str.get_strings([{\n                key: 'confirm'\n            },\n            {\n                key: 'enrolluserstocourse',\n                component: 'local_courses',\n                param: args\n            }]).then(function (s) {\n                ModalFactory.create({\n                    title: s[0],\n                    type: ModalFactory.types.DEFAULT,\n                    body: s[1],\n                    footer: '<button type=\"button\" class=\"btn btn-primary\" data-action=\"save\">Yes</button>&nbsp;' + \n                    '<button type=\"button\" class=\"btn btn-secondary\" data-action=\"cancel\">No</button>'\n                }).done(function (modal) {\n                    this.modal = modal;\n\n                    modal.getRoot().find('[data-action=\"save\"]').on('click', function () {\n                        window.location.href = M.cfg.wwwroot+ '/local/courses/courseautoenrol.php?confirmation=1&id='+args.courseid;\n                    }.bind(this));\n                    modal.getFooter().find('[data-action=\"cancel\"]').on('click', function () {\n                        modal.setBody('');\n                        modal.hide();\n                    });\n                    modal.show();\n                }.bind(this));\n            }.bind(this));\n        },\n    };\n    \n});\n"],"names":["define","DataTable","$","Str","ModalFactory","Ajax","courses","load","usersdatatable","args","console","log","params","action","courseid","moduletype","get_strings","key","component","then","s","dataTable","M","cfg","wwwroot","deleteuser","element","userid","create","title","type","types","DEFAULT","body","footer","util","get_string","done","modal","getRoot","find","on","window","location","href","id","sesskey","bind","this","getFooter","setBody","hide","show","enrollUsers","param"],"mappings":"AAAAA,+BAAO,CACH,kCACA,SAAS,WAAW,qBAAsB,cAC3C,SAASC,UAAWC,EAAEC,IAAIC,aAAcC,aAChCC,QAAU,CACbC,KAAO,aAEPC,eAAiB,SAASC,MACtBC,QAAQC,IAAIF,MACZG,OAAS,GACTA,OAAOC,OAASJ,KAAKI,OACrBD,OAAOE,SAAWL,KAAKK,SACvBF,OAAOG,WAAaN,KAAKM,WAClCZ,IAAIa,YAAY,CAAC,CACJC,IAAK,SACLC,UAAW,iBAEf,CACID,IAAK,oBACLC,UAAW,mBACXC,MAAK,SAASC,GACDlB,EAAE,iBAAiBmB,UAAU,QAC7B,cACK,cACA,YACF,OACJ,MACI,WACDC,EAAEC,IAAIC,QAAU,+BACfZ,uBAEK,WACL,UACI,MACA,aACI,gBAEF,YAAYU,EAAEC,IAAIC,QAAU,qCAEjC,SACCJ,EAAE,gBACPA,EAAE,UAKvBK,WAAY,SAASC,SACEA,QAAQC,cAEpBxB,IAAIa,YAAY,CAAC,CACpBC,IAAK,aACLC,UAAW,iBACZ,CACCD,IAAK,gBACLC,UAAW,mBACXC,KAAK,SAASC,GACdhB,aAAawB,OAAO,CAChBC,MAAOT,EAAE,GACTU,KAAM1B,aAAa2B,MAAMC,QACzBC,KAAMb,EAAE,GACRc,OAAQ,oEAAoEZ,EAAEa,KAAKC,WAAW,MAAO,UAA7F,uFACgEd,EAAEa,KAAKC,WAAW,KAAM,UAAU,cAC3GC,KAAK,SAASC,YACRA,MAAQA,MACbA,MAAMC,UAAUC,KAAK,wBAAwBC,GAAG,QAAS,WACrDC,OAAOC,SAASC,KAAM,wBAAwBlB,QAAQmB,GAAG,OAAOnB,QAAQC,OAAO,sBAAwBL,EAAEC,IAAIuB,SAC/GC,KAAKC,OACPV,MAAMW,YAAYT,KAAK,0BAA0BC,GAAG,SAAS,WACzDH,MAAMY,QAAQ,IACdZ,MAAMa,UAEVb,MAAMc,QACRL,KAAKC,QACTD,KAAKC,QAEXK,YAAa,SAAU5C,aAEZN,IAAIa,YAAY,CAAC,CACpBC,IAAK,WAET,CACIA,IAAK,sBACLC,UAAW,gBACXoC,MAAO7C,QACPU,KAAK,SAAUC,GACfhB,aAAawB,OAAO,CAChBC,MAAOT,EAAE,GACTU,KAAM1B,aAAa2B,MAAMC,QACzBC,KAAMb,EAAE,GACRc,OAAQ,wKAETG,KAAK,SAAUC,YACTA,MAAQA,MAEbA,MAAMC,UAAUC,KAAK,wBAAwBC,GAAG,QAAS,WACrDC,OAAOC,SAASC,KAAOtB,EAAEC,IAAIC,QAAS,wDAAwDf,KAAKK,UACrGiC,KAAKC,OACPV,MAAMW,YAAYT,KAAK,0BAA0BC,GAAG,SAAS,WACzDH,MAAMY,QAAQ,IACdZ,MAAMa,UAEVb,MAAMc,QACRL,KAAKC,QACTD,KAAKC"}