define("local_costcenter/form-options-selector",["jquery","core/ajax","core/templates","core/str"],(function($,Ajax,Templates,Str){return{processResults:function(selector,results){var options=[];return $.isArray(results)?($.each(results,(function(index,option){options.push({value:option.id,label:option._label})})),options):results},transport:function(selector,query,success,failure){if(contextid=parseInt($(selector).data("contextid"),10),action=$(selector).data("action"),formoptions=$(selector).data("options"),Str.get_strings([{key:"selectdept",component:"local_courses"},{key:"selectsubdept",component:"local_courses"},{key:"selectcat",component:"local_courses"},{key:"selectcoursetype",component:"local_courses"}]).then((function(s){var departmentselect="<span><span>"+s[0]+"</span></span>",subdeptartmentselect="<span><span>"+s[1]+"</span></span>",categoryselect="<span><span>"+s[2]+"</span></span>",course_typeselect="<span><span>"+s[3]+"</span></span>";"costcenter_organisation_selector"===action||"costcenter_element_selector"===action?$("#id_open_costcenterid_select").on("change",(function(){var department=$("#id_open_departmentid").val();parseInt(department)>=0&&($("#id_open_departmentid").html(""),$(".departmentselect .form-autocomplete-selection").html(departmentselect));var subdept=$("#id_open_subdepartment").val();parseInt(subdept)>=0&&($("#id_open_subdepartment").html(""),$(".subdepartmentselect .form-autocomplete-selection").html(subdeptartmentselect));var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect));category=$("#id_open_categoryid").val();parseInt(category)>0&&($("#id_open_categoryid").html(""),$(".idparentselect .form-autocomplete-selection").html(categoryselect));var identifiedas=$("#id_identifiedtype").val();parseInt(identifiedas)>0&&($("#id_identifiedtype").html(""),$(".identifiedasselect .form-autocomplete-selection").html(course_typeselect))})):"costcenter_department_selector"===action||"costcenter_subdepartment_selector"===action?($("#id_open_departmentid").on("change",(function(){var subdept=$("#id_open_subdepartment").val();parseInt(subdept)>=0&&($("#id_open_subdepartment").html(""),$(".subdepartmentselect .form-autocomplete-selection").html(subdeptartmentselect));var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect))})),$("#id_open_subdepartment").on("change",(function(){var category=$("#id_category").val();parseInt(category)>0&&($("#id_category").html(""),$(".categoryselect .form-autocomplete-selection").html(categoryselect))}))):"costecenter_coursetype_selector"===action?$("#id_open_identifiedtype").on("change",(function(){var category=$("#id_open_identifiedtype").val();parseInt(category)>0&&($("#id_open_identifiedtype").html(""),$(".identifiedasselect .form-autocomplete-selection").html(course_typeselect))})):"costcenter_element_selector"===action&&$(document).on("change",'[data-action="costcenter_element_selector"]',(function(){var elemvalue=$(this).val();if(parseInt(elemvalue)>0){var depth=$(this).data("depth");if($.each($('[data-action="costcenter_element_selector"]'),(function(index,value){$(value).data("depth")>depth&&($(value).html(""),$(value).parent().find(".form-autocomplete-selection").html($(value).data("selectstring")))})),1==depth){var value=$('[data-class="supervisor_select"]');value.html(""),value.parent().find(".form-autocomplete-selection").html(value.data("selectstring"))}}}))})),"costcenter_department_selector"===action||"costcenter_subdepartment_selector"===action||"costecenter_coursetype_selector"===action||"costcenter_element_selector"===action||"custom_category_selector"===action||"user_supervisor_selector"===action||"user_position_selector"===action||"user_domain_selector"===action||"custom_matrix_selector"===action){var parentid=$('[data-class="'+$(selector).data("parentclass")+'"]').val();null==parentid&&formoptions.parentid>0||(formoptions.parentid=parentid),"user_position_selector"===action&&(formoptions.domainid=$("#id_open_domainid").val())}else"costcenter_category_selector"===action?(formoptions.organisationid=$("#id_open_costcenterid").val(),formoptions.departmentid=$("#id_open_departmentid").val(),formoptions.subdepartment=$("#id_open_subdepartment").val(),formoptions.name=$("#id_open_identifiedtype").val()):"perforance_parameter_selector"===action&&(formoptions.typeparent=$("#id_open_performancetype").val());formoptions=JSON.stringify(formoptions),Ajax.call([{methodname:"local_costcenter_form_option_selector",args:{query:query,context:{contextid:contextid},action:action,options:formoptions,searchanywhere:!0,page:0,perpage:101}}])[0].then((function(results){results=$.parseJSON(results);var promises=[],i=0;return"local_costcenter/form-option-selector-suggestion",results.length<=100?($.each(results,(function(index,option){var ctx=option;ctx.hasidentity=!0,ctx.identity=[].join(", "),promises.push(Templates.render("local_costcenter/form-option-selector-suggestion",ctx))})),$.when.apply($.when,promises).then((function(){var args=arguments;$.each(results,(function(index,option){option._label=args[i],i++})),success(results)}))):Str.get_string("toomanyoptionstoshow","local_costcenter",">100").then((function(toomanyoptionstoshow){success(toomanyoptionstoshow)}))})).fail(failure)}}}));

//# sourceMappingURL=form-options-selector.min.js.map