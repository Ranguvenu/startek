{"version":3,"file":"classroom.min.js","sources":["../src/classroom.js"],"sourcesContent":["/**\n * Add a create new group modal to the page.\n *\n * @module     core_group/AjaxForms\n * @class      AjaxForms\n * @package    core_group\n * @copyright  2017 Damyon Wiese <damyon@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'core/str',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/ajax',\n    'core/templates',\n    'jquery',\n    'local_costcenter/cardPaginate',\n    'jqueryui'\n], function(Str, ModalFactory, ModalEvents, Ajax, Templates, $,Cardpaginate) {\n    var classroom;\n    return classroom = {\n        init: function(args) {\n            this.AssignUsers(args);\n        },\n        completionInfo: function(params) {\n            \n            var name = params.name;\n            var target = \".\"+name;\n            var promise = Ajax.call([{\n                methodname: 'local_classroom_classroomview'+name,\n                args: params\n            }]);\n            $(\"#sessions_tabdataid\").empty();\n            $(\"#coursesid\").empty();\n            $(\"#usersid\").empty();\n            $(\"#feedbacksid\").empty();\n            $(\"#requestedusersid\").empty();\n            $(\".tab-pane\").removeClass('active');\n            $(\"#\"+name).addClass('active');\n\n            promise[0].done(function(resp) {\n                var data = Templates.render('local_classroom/classroomview'+name, {response: resp});\n                data.then(function(response){\n                    $(target).html(response);\n                });\n            }).fail(function(ex) {\n                // do something with the exception\n                console.log(ex);\n            });\n        },\n        classroomsData: function(params) {\n            var targetid = 'all';\n            var view_type = params;\n        \n            if(view_type == 'card'){\n            var options = {targetID: targetid,\n                        templateName: 'local_classroom/classrooms_list',\n                        methodName: 'local_classroom_get_classrooms',\n                        perPage: 6,\n                        cardClass: 'col-md-6 col-12',\n                        viewType: 'card'};\n              }else {\n               var options = {targetID: targetid,\n                        templateName: 'local_classroom/classrooms_catalog_list',\n                        methodName: 'local_classroom_get_classrooms',\n                        perPage: 10,\n                        cardClass: 'tableformat',\n                        viewType: 'table'};\n              }\n            var dataoptions = {status: '-1', view_type: params};\n\n            Cardpaginate.reload(options, dataoptions);\n        },\n        \n        sessionsData: function(params) {\n            var targetid = 'sessions_tabdata';\n            var options = {targetID: targetid,\n                        templateName: 'local_classroom/classroomviewsessions',\n                        methodName: 'local_classroom_classroomviewsessions',\n                        perPage: 5,\n                        cardClass: 'col-md-6 col-12',\n                        viewType: 'card'};\n\n            var dataoptions = {tabname: 'sessions',classroomid: params};\n            var filterdata = {};\n\n            Cardpaginate.reload(options, dataoptions,filterdata);\n        },\n        deleteConfirm: function(args) {\n            console.log(args);\n            return Str.get_strings([{\n                key: 'confirmation',\n                component: 'local_classroom'\n            },\n            {\n                key: 'deleteconfirm',\n                component: 'local_classroom',\n                param: args.classroomname,\n            },\n            {\n                key: 'deleteallconfirm',\n                component: 'local_classroom',\n                param: args.sessionname,\n            },\n            {\n                key: 'yes'\n            },\n            {\n                key: 'deletecourseconfirm',\n                component: 'local_classroom',\n                param: args.name,\n            },\n            {\n                key: 'unenrollclassroom',\n                component: 'local_classroom',\n                param: args.classroomname,\n            },\n            \n            {\n                key: 'requestprocessing',\n                component: 'local_classroom'\n            },\n            {\n                key: 'deletefeedbackconfirm',\n                component: 'local_classroom',\n                param: args.feedbackname,\n            },\n\n\n            ]).then(function(s) {\n                 if(args.action==\"deleteclassroom\"){\n                    s[1]=s[1];\n                 }\n                 else if(args.action==\"unenrollclassroom\"){\n                    s[1]=s[5];\n                 }\n                 else if(args.action==\"deleteclassroomcourse\"){\n                    s[1]=s[4];\n                 }\n                 else if(args.action==\"deleteclassroomevaluation\"){\n                    s[1]=s[7];\n                 }\n                 else{\n                     s[1]=s[2];\n                 }\n                ModalFactory.create({\n\n                    title: s[0],\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    body: s[1]\n                }).done(function(modal) {\n                    this.modal = modal;\n                    modal.setSaveButtonText(s[3]);\n                    modal.getRoot().on(ModalEvents.save, function(e) {\n                        this.modal.setBody('<span class=\"loading-icon icon-no-margin\"><img src='+M.cfg.wwwroot + '/local/ajax-loader.svg></span>');\n                        this.modal.hideFooter();\n                        this.modal.setTitle(s[6]);\n                        $('[data-action=\"hide\"]').css('display','none');\n                        e.preventDefault();\n                        args.confirm = true;\n                        var promise = Ajax.call([{\n                            methodname: 'local_classroom_' + args.action,\n                            args: args\n                        }]);\n                        promise[0].done(function(resp) {\n                            if(args.action==\"deleteclassroom\"){\n                                 window.location.href = M.cfg.wwwroot + '/local/classroom/index.php';\n                            }else{\n                                 window.location.href = M.cfg.wwwroot + '/local/classroom/view.php?cid='+args.classroomid;\n                            }\n                           \n                        }).fail(function(ex) {\n                            // do something with the exception\n                             console.log(ex);\n                        });\n                    }.bind(this));\n                    modal.show();\n                }.bind(this));\n            }.bind(this));\n        },\n        AssignUsers: function(args) {\n            $('.usersselect').click(function() {\n                var type = $(this).data('id');\n\n                if (type === 'removeselect') {\n                    $('input#remove').prop('disabled', false);\n                    $('input#add').prop('disabled', true);\n                } else if (type === 'addselect') {\n                    $('input#remove').prop('disabled', true);\n                    $('input#add').prop('disabled', false);\n                }\n\n                if ($(this).hasClass('select_all')) {\n                    $('#' + type + ' option').prop('selected', true);\n                } else if ($(this).hasClass('remove_all')) {\n                    $('#' + type ).val('').trigger(\"change\");\n                }\n            });\n        },\n        classroomStatus: function(args) {\n            return Str.get_strings([\n            {\n                key: 'confirmation',\n                component: 'local_classroom'\n            },\n            {\n                key: args.actionstatusmsg,\n                component: 'local_classroom'\n            },\n            {\n                key: 'yes'\n            },\n            {\n                key: 'requestprocessing',\n                component: 'local_classroom'\n            }\n            ]).then(function(s) {\n                ModalFactory.create({\n                    title: s[0],\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    body: s[1]\n                }).done(function(modal) {\n                    this.modal = modal;\n                    modal.setSaveButtonText(s[2]);\n                    modal.getRoot().on(ModalEvents.save, function(e) {\n                        this.modal.setBody('<span class=\"loading-icon icon-no-margin\"><img src='+M.cfg.wwwroot + '/local/ajax-loader.svg></span>');\n                        this.modal.hideFooter();\n                        this.modal.setTitle(s[3]);\n                        $('[data-action=\"hide\"]').css('display','none');\n                        e.preventDefault();\n                        args.confirm = true;\n                        var promise = Ajax.call([{\n                            methodname: 'local_classroom_' + args.action,\n                            args: args\n                        }]);\n                        promise[0].done(function(resp) {\n                            window.location.href = window.location.href;\n                        }).fail(function(ex) {\n                            // do something with the exception\n                             console.log(ex);\n                        });\n                    }.bind(this));\n                    modal.show();\n                }.bind(this));\n            }.bind(this));\n        },\n        ManageclassroomStatus: function(args) {\n            return Str.get_strings([{\n                key: 'confirmation',\n                component: 'local_classroom'\n            },\n            {\n                key: args.actionstatusmsg,\n                component: 'local_classroom',\n                param: args.classroomname,\n            },\n            {\n                key: 'deleteallconfirm',\n                component: 'local_classroom'\n            },\n            {\n                key: 'yes'\n            },\n            {\n                key: 'requestprocessing',\n                component: 'local_classroom'\n            },\n            {\n                key: 'information',\n                component: 'local_classroom'\n            }\n            ]).then(function(s) {\n                ModalFactory.create({\n                    title: s[0],\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    body: s[1]\n                }).done(function(modal) {\n                    this.modal = modal;\n                    modal.setSaveButtonText(s[3]);\n                    modal.getRoot().on(ModalEvents.save, function(e) {\n                        this.modal.setBody('<span class=\"loading-icon icon-no-margin\"><img src='+M.cfg.wwwroot + '/local/ajax-loader.svg></span>');\n                        this.modal.hideFooter();\n                        this.modal.setTitle(s[4]);\n                        $('[data-action=\"hide\"]').css('display','none');\n\n                        e.preventDefault();\n                        args.confirm = true;\n                        var promise = Ajax.call([{\n                            methodname: 'local_classroom_manageclassroomStatus',\n                            args: args\n                        }]);\n                        promise[0].done(function(resp) {\n                            if(args.action==\"enrolrequest\"){\n                                location.reload();\n\n                            }else if(args.action==\"selfenrol\"){\n                                if(resp.return_status ==''){\n                                    // location.reload();\n                                    window.location.href = M.cfg.wwwroot + '/local/classroom/view.php?cid='+args.classroomid;\n                                }else{\n                                    modal.setBody(resp.return_status);\n                                    modal.setTitle(s[5]);\n                                    $('[data-action=\"hide\"]').css('display','block');\n                                }\n\n                            }else{\n                                window.location.href = M.cfg.wwwroot + '/local/classroom/view.php?cid='+args.classroomid;\n\n                            }\n                            $(\".close\").click(function(){\n                                    location.reload();\n                            });\n                        }).fail(function(ex) {\n                            // do something with the exception\n                             console.log(ex);\n                        });\n                    }.bind(this));\n                    modal.show();\n                }.bind(this));\n            }.bind(this));\n        },\n        load: function () {\n        }\n    };\n});  "],"names":["define","Str","ModalFactory","ModalEvents","Ajax","Templates","$","Cardpaginate","init","args","AssignUsers","completionInfo","params","name","target","promise","call","methodname","empty","removeClass","addClass","done","resp","render","response","then","html","fail","ex","console","log","classroomsData","options","targetID","templateName","methodName","perPage","cardClass","viewType","dataoptions","status","view_type","reload","sessionsData","tabname","classroomid","deleteConfirm","get_strings","key","component","param","classroomname","sessionname","feedbackname","s","action","create","title","type","types","SAVE_CANCEL","body","modal","setSaveButtonText","getRoot","on","save","e","setBody","M","cfg","wwwroot","hideFooter","setTitle","css","preventDefault","confirm","window","location","href","bind","this","show","click","data","prop","hasClass","val","trigger","classroomStatus","actionstatusmsg","ManageclassroomStatus","return_status","load"],"mappings":"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"}