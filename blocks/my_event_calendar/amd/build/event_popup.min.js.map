{"version":3,"file":"event_popup.min.js","sources":["../src/event_popup.js"],"sourcesContent":["/**\r\n * Add a create new event modal to the page.\r\n *\r\n * @module     blocks/my calendar\r\n * @package    calendar\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine(['jquery', 'core/str', 'core/modal_factory', 'core/modal_events', 'core/fragment', 'core/ajax', 'core/yui'],\r\n        function($, Str, ModalFactory, ModalEvents) {\r\n \r\n    return  {\r\n        popup_eventinfo: function(args){\r\n            var btn = '';\r\n            var event_details = '';\r\n            var pop_desc =  args.eventlocal_eventname;\r\n            if (args.eventeventtype == \"session_open\" || args.eventeventtype == \"open\") {\r\n                if (args.eventlocal_eventenddate == 'null') {\r\n                     event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-clock-o fa-fw \" aria-hidden=\"true\" title=\"When\" aria-label=\"When\"></i> </div><div class=\"col-11\"> Opens on ' + args.eventlocal_eventstartdate+ '</div></div>';\r\n                } else {\r\n                    event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-clock-o fa-fw \" aria-hidden=\"true\" title=\"When\" aria-label=\"When\"></i> </div><div class=\"col-11\">' + args.eventlocal_eventstartdate+ ' - '+ args.eventlocal_eventenddate+ '</div></div>';\r\n                }\r\n            } else if (args.eventeventtype == \"session_close\" || args.eventeventtype == \"close\") {\r\n                event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-clock-o fa-fw \" aria-hidden=\"true\" title=\"When\" aria-label=\"When\"></i> </div><div class=\"col-11\"> Closes on ' + args.eventlocal_eventenddate+ '</div></div>';\r\n            }\r\n\r\n            event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-align-left fa-fw \" aria-hidden=\"true\" title=\"Trainers\" aria-label=\"Trainers\"></i></i> </div><div class=\"col-11\">' + args.eventtrainer + '</div></div>';\r\n            event_details += '<div class=\"row  mt-10 mb-10\"><div class=\"col-1\"> <i class=\"icon fa fa-map-marker fa-fw \" aria-hidden=\"true\" title=\"Location\" aria-label=\"Location\"></i> </div><div class=\"col-11\">' + args.eventlocation + '</div></div>';\r\n           \r\n            btn += '<ul class=\"eventpopup_footer\">';\r\n            switch (args.eventplugin) {\r\n                case 'local_classroom':\r\n                    if((args.eventenrolled == false) && (args.eventself_enrol == true)) {                                            \r\n                        var button_classroom = function () {\r\n                            var tmp = null;\r\n                            $.ajax({\r\n                                async: false,\r\n                                type: \"POST\",\r\n                                global: false,\r\n                                dataType: \"json\",\r\n                                url: M.cfg.wwwroot + '/blocks/training_calendar/ajax.php?instance='+args.eventinstance+'&plugin=local_classroom',\r\n                                success: function (returndata) {\r\n                                    if ((returndata == 1)) {\r\n                                      tmp = '<li><a href= \"javascript:void(0)\" onclick=\"(function(e){ require(\\'local_classroom/classroom\\').ManageclassroomStatus({action:\\'selfenrol\\', id: '+args.eventinstance+', classroomid:'+args.eventinstance+',actionstatusmsg:\\'classroom_self_enrolment\\',classroomname:\\''+args.eventlocal_eventname+'\\'}) })(event)\"><button class=\"btn\">Enrol</button></a> </li>';\r\n                                    } else {\r\n                                       tmp = '<li>Not published</li>';\r\n                                    }\r\n                                }\r\n                            });\r\n                            return tmp;\r\n                        }();\r\n                        btn += button_classroom;\r\n                        \r\n                    }\r\n                    \r\n                    else if(args.eventenrolled == true) {\r\n                       btn += '<li><a href= \"' + M.cfg.wwwroot + '/local/classroom/view.php?cid=' + args.eventinstance +'\" target=\"_blank\"><button class=\"btn\">Launch</button></a> </li>';\r\n                    }\r\n                break;\r\n                case 'local_program':\r\n                    if((args.eventenrolled == false) && (args.eventself_enrol == true)) {\r\n                        var button_program = function () {\r\n                            var tmp = null;\r\n                            $.ajax({\r\n                                async: false,\r\n                                type: \"POST\",\r\n                                global: false,\r\n                                dataType: \"json\",\r\n                                url: M.cfg.wwwroot + '/blocks/training_calendar/ajax.php?instance='+args.eventinstance+'&plugin=local_program',\r\n                                success: function (returndata) {                         \r\n                                    if ((returndata == 1)) {                                \r\n                                      tmp = '<li><a href= \"javascript:void(0)\" onclick=\"(function(e){ require(\\'local_program/program\\').ManageprogramStatus({action:\\'selfenrol\\', id: '+args.eventinstance+', programid:'+args.eventinstance+',actionstatusmsg:\\'program_self_enrolment\\',programname:\\''+args.eventlocal_eventname+'\\'}) })(event)\"><button class=\"btn\">Enrol</button></a> </li>';\r\n                                    } else {\r\n                                       tmp = '<li>Not published</li>';\r\n                                    }\r\n                                }\r\n                            });\r\n                            return tmp;\r\n                        }();\r\n                        btn += button_program;\r\n                    }\r\n                    \r\n                    else if(args.eventenrolled == true)\r\n                    btn += '<li><a href= \"' + M.cfg.wwwroot + '/local/program/view.php?bcid=' + args.eventinstance +'\" target=\"_blank\"><button class=\"btn\">Launch</button></a> </li>';\r\n                break;\r\n                case 'local_certification':\r\n                    if((args.eventenrolled == false) && (args.eventself_enrol == true)) {\r\n                        var button_certification = function () {\r\n                            var tmp = null;\r\n                            $.ajax({\r\n                                async: false,\r\n                                type: \"POST\",\r\n                                global: false,\r\n                                dataType: \"json\",\r\n                                url: M.cfg.wwwroot + '/blocks/training_calendar/ajax.php?instance='+args.eventinstance+'&plugin=local_certification',\r\n                                success: function (returndata) {                      \r\n                                    if ((returndata == 1)) {                                \r\n                                      tmp = '<li><a href= \"javascript:void(0)\"  onclick=\"(function(e){ require(\\'local_certification/certification\\').ManagecertificationStatus({action:\\'selfenrol\\', id: '+args.eventinstance+', certificationid:'+args.eventinstance+',actionstatusmsg:\\'certification_self_enrolment\\',certificationname:\\''+args.eventlocal_eventname+'\\'}) })(event)\"><button class=\"btn\">Enrol</button></a> </li>';\r\n                                    } else {\r\n                                       tmp = '<li>Not published</li>';\r\n                                    }\r\n                                }\r\n                            });\r\n                            return tmp;\r\n                        }();\r\n                        btn += button_certification;\r\n                    }\r\n                    \r\n                    else if(args.eventenrolled == true)\r\n                    btn += '<li><a href= \"' + M.cfg.wwwroot + '/local/certification/view.php?ctid=' + args.eventinstance +'\" target=\"_blank\"><button class=\"btn\">Launch</button></a> </li>';\r\n                break;\r\n                default:\r\n                btn += '<li><a href=\"'+ M.cfg.wwwroot+'\" target=\"_blank\"></li>';\r\n            }\r\n            btn += '</ul>';\r\n\r\n            ModalFactory.create({\r\n                title: pop_desc,\r\n                body: event_details,\r\n                footer: btn\r\n            }).done(function(modal) {\r\n                modal.show();\r\n                modal.getRoot().click(function(e) {\r\n                    modal.show();\r\n                }.bind(this));\r\n                $(\".close\").click(function(e) {\r\n                    modal.hide();\r\n                    modal.destroy();\r\n                }.bind(this));\r\n            });\r\n        },\r\n        load: function () {\r\n            // do nothing\r\n        }\r\n    };\r\n});"],"names":["define","$","Str","ModalFactory","ModalEvents","popup_eventinfo","args","tmp","btn","event_details","pop_desc","eventlocal_eventname","eventeventtype","eventlocal_eventenddate","eventlocal_eventstartdate","eventtrainer","eventlocation","eventplugin","eventenrolled","eventself_enrol","ajax","async","type","global","dataType","url","M","cfg","wwwroot","eventinstance","success","returndata","button_program","button_certification","create","title","body","footer","done","modal","show","getRoot","click","e","bind","this","hide","destroy","load"],"mappings":";;;;;;;AAOAA,6CAAO,CAAC,SAAU,WAAY,qBAAsB,oBAAqB,gBAAiB,YAAa,aAC/F,SAASC,EAAGC,IAAKC,aAAcC,mBAE3B,CACJC,gBAAiB,SAASC,UAsBFC,IArBhBC,IAAM,GACNC,cAAgB,GAChBC,SAAYJ,KAAKK,4BACM,gBAAvBL,KAAKM,gBAA2D,QAAvBN,KAAKM,eACV,QAAhCN,KAAKO,wBACJJ,eAAiB,qLAAuLH,KAAKQ,0BAA2B,eAEzOL,eAAiB,2KAA6KH,KAAKQ,0BAA2B,MAAOR,KAAKO,wBAAyB,eAEzO,iBAAvBP,KAAKM,gBAA4D,SAAvBN,KAAKM,iBACtDH,eAAiB,sLAAwLH,KAAKO,wBAAyB,gBAG3OJ,eAAiB,0LAA4LH,KAAKS,aAAe,eACjON,eAAiB,sLAAwLH,KAAKU,cAAgB,eAE9NR,KAAO,iCACCF,KAAKW,iBACJ,qBACyB,GAAtBX,KAAKY,eAAoD,GAAxBZ,KAAKa,gBAmBtCX,MAjBQD,IAAM,KACVN,EAAEmB,KAAK,CACHC,OAAO,EACPC,KAAM,OACNC,QAAQ,EACRC,SAAU,OACVC,IAAKC,EAAEC,IAAIC,QAAU,+CAA+CtB,KAAKuB,cAAc,0BACvFC,QAAS,SAAUC,YAEbxB,IADiB,GAAdwB,WACG,mJAAoJzB,KAAKuB,cAAc,iBAAiBvB,KAAKuB,cAAc,8DAAiEvB,KAAKK,qBAAqB,+DAErS,4BAIVJ,UAMe,GAAtBD,KAAKY,gBACVV,KAAO,iBAAmBkB,EAAEC,IAAIC,QAAU,iCAAmCtB,KAAKuB,cAAe,6EAGnG,mBACyB,GAAtBvB,KAAKY,eAAoD,GAAxBZ,KAAKa,gBAA0B,KAC5Da,eAAiB,eACbzB,IAAM,YACVN,EAAEmB,KAAK,CACHC,OAAO,EACPC,KAAM,OACNC,QAAQ,EACRC,SAAU,OACVC,IAAKC,EAAEC,IAAIC,QAAU,+CAA+CtB,KAAKuB,cAAc,wBACvFC,QAAS,SAAUC,YAEbxB,IADiB,GAAdwB,WACG,6IAA8IzB,KAAKuB,cAAc,eAAevB,KAAKuB,cAAc,0DAA6DvB,KAAKK,qBAAqB,+DAEzR,4BAIVJ,IAhBU,GAkBrBC,KAAOwB,oBAGmB,GAAtB1B,KAAKY,gBACbV,KAAO,iBAAmBkB,EAAEC,IAAIC,QAAU,gCAAkCtB,KAAKuB,cAAe,6EAE/F,yBACyB,GAAtBvB,KAAKY,eAAoD,GAAxBZ,KAAKa,gBAA0B,KAC5Dc,qBAAuB,eACnB1B,IAAM,YACVN,EAAEmB,KAAK,CACHC,OAAO,EACPC,KAAM,OACNC,QAAQ,EACRC,SAAU,OACVC,IAAKC,EAAEC,IAAIC,QAAU,+CAA+CtB,KAAKuB,cAAc,8BACvFC,QAAS,SAAUC,YAEbxB,IADiB,GAAdwB,WACG,gKAAiKzB,KAAKuB,cAAc,qBAAqBvB,KAAKuB,cAAc,sEAAyEvB,KAAKK,qBAAqB,+DAE9T,4BAIVJ,IAhBgB,GAkB3BC,KAAOyB,0BAGmB,GAAtB3B,KAAKY,gBACbV,KAAO,iBAAmBkB,EAAEC,IAAIC,QAAU,sCAAwCtB,KAAKuB,cAAe,iFAG1GrB,KAAO,gBAAiBkB,EAAEC,IAAIC,QAAQ,0BAE1CpB,KAAO,QAEPL,aAAa+B,OAAO,CAChBC,MAAOzB,SACP0B,KAAM3B,cACN4B,OAAQ7B,MACT8B,MAAK,SAASC,OACbA,MAAMC,OACND,MAAME,UAAUC,MAAM,SAASC,GAC3BJ,MAAMC,QACRI,KAAKC,OACP5C,EAAE,UAAUyC,MAAM,SAASC,GACvBJ,MAAMO,OACNP,MAAMQ,WACRH,KAAKC,WAGfG,KAAM"}