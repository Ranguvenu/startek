$(document).ready(function() {
    $("a").removeAttr("style");
	var sun = M.util.get_string('sun', 'block_my_event_calendar');
	var mon = M.util.get_string('mon', 'block_my_event_calendar');
	var tue = M.util.get_string('tue', 'block_my_event_calendar');
	var wed = M.util.get_string('wed', 'block_my_event_calendar');
	var thu = M.util.get_string('thu', 'block_my_event_calendar');
	var fri = M.util.get_string('fri', 'block_my_event_calendar');
	var sat = M.util.get_string('sat', 'block_my_event_calendar');
    var january = M.util.get_string('january', 'block_my_event_calendar'); 
    var february = M.util.get_string('february', 'block_my_event_calendar'); 
    var march = M.util.get_string('march', 'block_my_event_calendar'); 
    var april = M.util.get_string('april', 'block_my_event_calendar'); 
    var may = M.util.get_string('may', 'block_my_event_calendar'); 
    var june = M.util.get_string('june', 'block_my_event_calendar'); 
    var july = M.util.get_string('july', 'block_my_event_calendar'); 
    var august = M.util.get_string('august', 'block_my_event_calendar'); 
    var september = M.util.get_string('september', 'block_my_event_calendar'); 
    var october = M.util.get_string('october', 'block_my_event_calendar'); 
    var november = M.util.get_string('november', 'block_my_event_calendar'); 
    var december = M.util.get_string('december', 'block_my_event_calendar');
    $('#calendar').fullCalendar({
        dayNamesShort: [sun,mon,tue,wed,thu,fri,sat],
        // monthNamesShort:['1','2','3','4','1','2','3','4','1','2','3','4'],
        monthNames: [january, february, march, april, may, june, july, august, september, october, november, december],
        // monthNamesShort: ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'],
        // dayNames: ['Domingo','Lunes','Martes','Miércoles','Jueves','Viernes','Sábado'],
        // dayNamesShort: ['Dom','Lun','Mar','Mié','Jue','Vie','Sáb'],
        header: {
            left: '',
            center: 'prev title next',
            right: ''
        },
        weekends: true,
        themeSystem:'bootstrap3',
        fixedWeekCount: false,
        eventLimit: true,
        axisFormat: 'h:mm',
        defaultDate: new Date(),
        selectable: true,
        defaultView: 'month',
        events: $.ajax({
                method: "GET",
                dataType: "json",
                url: M.cfg.wwwroot + '/blocks/my_event_calendar/events.php',
                success: function (event) {
                    $("#eventInfo").html(event);
                        $(".event_table").DataTable({
                            'language': {
                                'paginate': {
                                    'previous': '<',
                                    'next': '>'
                                },
                                "emptyTable": 	M.util.get_string('no_events_sheduled', 'block_my_event_calendar')
,
                            },
                        'bFilter': false,
                        'bInfo': false,
                        'pageLength': 4,

                        });
                    $('#EventDate').html('');
                    
                }
            }),
        cache: true,
        events: M.cfg.wwwroot + '/blocks/my_event_calendar/events.php?text=default',
        eventRender: function eventRender(event,view) {
            dt = new Date();
            var resp = '';
            var dateString = moment(event.start).format('YYYY-MM-DD');
            $('#calendar').find('.fc-day-top[data-date="' + dateString + '"]').addClass(event.plugin);
        },
        viewRender: function(view){
            dt = new Date();
            if ( moment(dt).format('MMM YYYY') == view.title) {
                if (($( "#eventInfo" ).hasClass( "hasevent" ))) {
                    $("#pop_desc").css("display", "none");
                } else {
                    $("#pop_desc").css("display", "block");                         
                }
            }
            
        },
        dayClick: function(date) {
            var datein_style = moment(date._i).format('YYYY-MM-DD');
            $("#pop_desc").css("display", "none");
            $.ajax({
                method: "GET",
                dataType: "json",
                url: M.cfg.wwwroot + '/blocks/my_event_calendar/events.php?start='+datein_style+'&end='+datein_style,
                success: function (event) {
                    
                    $("#eventInfo").html(event);
                        $(".event_table").DataTable({
                            'language': {
                                'paginate': {
                                    'previous': '<',
                                    'next': '>'
                                },
                                "emptyTable": "No events scheduled",
                            },
                        'bFilter': false,
                        'bInfo': false,
                        'pageLength': 4,

                        });
                    $('#EventDate').html('');
                    
                }
            });
        },
        loading: function(bool) {
            if (bool)
            $('#loading').show();
            else
            $('#loading').hide();

        }
    });
});
$(document).ready(function() {
    if ($(this).hasClass('fc-event-container')) {
        $(this).closest('.nav-column').siblings('div.home').toggleClass("off");
    }
    $(".fc-next-button").click(function() {
        $('#EventDate').html('');
        $('#eventInfo').html('');
    });
    $(".fc-prev-button").click(function() {
        $('#EventDate').html('');
        $('#eventInfo').html('');
    });
});

