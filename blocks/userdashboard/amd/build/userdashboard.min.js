/**
 * Handle selection changes and actions on the competency tree.
 *
 * @module     block_userdasboard/navigations
 * @package    block_userdasboard
 * @copyright  2018 hemalathacarun <hemalatha@eabyas.in>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_userdashboard/userdashboard",["jquery","core/url","core/templates","core/notification","core/str","core/ajax","local_costcenter/cardPaginate","local_courses/jquery.dataTables"],(function($,url,Templates,notification,str,Ajax,cardPaginate,dataTable){var userdashboard=function(method,enabled_tab,thisdata){var params={};params.filter=thisdata.status,params.filter_text=thisdata.filter_text,params.filter_offset=0,params.filter_limit=10,thisdata.container.removeClass("justify-content-end"),thisdata.container.addClass("justify-content-center d-flex align-items-center"),thisdata.container.html('<img class="loading_img" src="'+M.cfg.wwwroot+'/local/ajax-loader.svg">'),Ajax.call([{methodname:method,args:params}])[0].done((function(resp){var data_display_type=$("#card_list_view").data("displaytype");"card"==data_display_type?resp.card_view=1:"table"==data_display_type?resp.list_view=1:resp.card_view=1,Templates.render(thisdata.templatename,resp).then((function(html,js){thisdata.container.html(html),thisdata.container.removeClass("justify-content-center d-flex align-items-center"),thisdata.container.addClass("justify-content-end")})).done((function(){1==resp.list_view?($(".userdashboard_filter_container").hide(),$.fn.dataTable.ext.errMode="none",$("#userdashboard_table_content").dataTable({pageLength:2,ordering:!1})):$(".userdashboard_filter_container").show()}))}))};return{init:function(){var container=$(".userdashboard_module_content");$(document).on("click",".userdashboard_menu_link",(function(){if(!$(this).parent(".dashboard-stat").hasClass("active_main_tab")){$(".dashboard-stat").removeClass("active_main_tab"),$(this).parent(".dashboard-stat").addClass("active_main_tab");var filter_text=$("#userdashboard_filter").val();null==filter_text&&(filter_text="");var data=$(this).data();data.container=container,data.filter_text=filter_text;var pluginname=data.pluginname,enabled_tab=data.tabname;return new userdashboard(pluginname+"_userdashboard_content",enabled_tab,data)}})),$(document).on("click",".userdashboard_tab_link",(function(){var filter_text=$("#userdashboard_filter").val();null==filter_text&&(filter_text="");var data=$(this).data();data.container=container.find(".divslide"),data.filter_text=filter_text;var pluginname=data.pluginname,enabled_tab=data.tabname;return $("#userdashboard_filter").data("filter",enabled_tab),$("#userdashboard_filter").data("status",enabled_tab),console.log($("#userdashboard_filter").data("filter")),new userdashboard(pluginname+"_userdashboard_content",enabled_tab,data)})),$(document).on("keyup","#userdashboard_filter",(function(){var filter_text=$(this).val(),data=$(this).data();console.log(data),data.container=container.find(".divslide"),data.filter_text=filter_text;var pluginname=data.pluginname,enabled_tab=data.tabname;return new userdashboard(pluginname+"_userdashboard_content",enabled_tab,data)})),$(document).on("click","#card_list_view",(function(){var display_type=$(this).data("displaytype");"card"==display_type?($(this).data("displaytype","table"),$(this).find("i").removeClass("fa-bars").addClass("fa-th"),$(this).find("span").html("Card")):"table"==display_type&&($(this).data("displaytype","card"),$(this).find("i").removeClass("fa-th").addClass("fa-bars"),$(this).find("span").html("List"));var element=$(".userdashboard_module_content .userdashboard_tab_link.active"),filter_text=$("#userdashboard_filter").val();null==filter_text&&(filter_text="");var data=element.data();console.log(element),data.container=container.find(".divslide"),data.filter_text=filter_text;var pluginname=data.pluginname,enabled_tab=data.tabname;return $("#userdashboard_filter").data("filter",enabled_tab),$("#userdashboard_filter").data("status",enabled_tab),new userdashboard(pluginname+"_userdashboard_content",enabled_tab,data)})),$(document).on("click","#card_list_view_detailed",(function(){var display_type=$(this).data("displaytype");if("card"==display_type)var newtype="table";else if("table"==display_type)newtype="card";var url=new URL(window.location.href);url.searchParams.set("formattype",newtype),window.location.href=url.href})),$(document).ready((function(){var data=$(".active_main_tab").find("a").data();data.container=container,data.filter_text="";var pluginname=data.pluginname,enabled_tab=data.tabname;return new userdashboard(pluginname+"_userdashboard_content",enabled_tab,data)}))},makeActive:function(identifier){$(document).ready((function(){$("#"+identifier).hasClass("active")||($("li.nav-item .nav-link.active").removeClass("active"),$("#"+identifier).addClass("active"))}))},load:function(){$(document).on("click",".userdashboard_tab_link",(function(){var data=$(this).data(),url=window.location.href,newurl=(url.indexOf("?tab"),url.substr(0,url.indexOf("?tab"))+"?tab="+data.tabname);history.pushState("","",newurl);var targetid=data.pluginname.replace("local","dashboard"),content="<div data-region='"+targetid+"-count-container'></div><div data-region='"+targetid+"-list-container' id ='"+targetid+"id'></div><span class='overlay-icon-container hidden' data-region='overlay-icon-container'><span class='loading-icon icon-no-margin'></span></span>",paginatedata=$(".userdashboard_content_detailed").data(),options=JSON.parse(JSON.parse(paginatedata.options)),dataoptions=JSON.parse(JSON.parse(paginatedata.dataoptions)),filterdata=JSON.parse(JSON.parse(paginatedata.filterdata));options.filter=data.tabname;var newoptions=options;$("#global_filter").val(""),$("#global_filter").data("options",newoptions),$("#"+targetid).html(content),cardPaginate.reload(newoptions,dataoptions,filterdata)}))}}}));

//# sourceMappingURL=userdashboard.min.js.map