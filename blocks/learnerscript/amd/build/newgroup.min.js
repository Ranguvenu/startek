/**
 * Add a create new group modal to the page.
 *
 * @module     core_group/newgroup
 * @class      NewGroup
 * @package    core_group
 * @copyright  2017 Damyon Wiese <damyon@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_learnerscript/newgroup",["jquery","core/str","core/modal_factory","core/modal_events","core/fragment","block_learnerscript/ajax","core/yui","core/templates","core/modal"],(function($,Str,ModalFactory,ModalEvents,Fragment,Ajax,Y,Templates,Modal){var NewGroup=function(args,url){this.args=args,this.contextid=1,this.url=url,this.nodeContent=args.nodeContent||"ajaxForm",this.init(this.args)};return NewGroup.prototype.modal=null,NewGroup.prototype.contextid=-1,NewGroup.prototype.init=function(args){var resp=this.getBody();$("body").append("<div class='"+this.nodeContent+"'></div>");resp.done((function(data){$(".ajaxForm").html(data.html),$("head").append(data.javascript)}));var dlg=$("."+this.nodeContent).dialog({resizable:!0,autoOpen:!1,width:"60%",title:this.args.title,modal:!0,close:function(event,ui){$(this).dialog("destroy").remove()}}),self=this;$("."+this.nodeContent+" .mform").bind("submit",(function(e){e.preventDefault(),self.submitFormAjax(this)})),dlg.dialog("open")},NewGroup.prototype.getBody=function(formdata){return void 0===formdata?formdata=null:this.args.jsonformdata=JSON.stringify(formdata),Ajax.call({args:this.args,url:this.url},!1)},NewGroup.prototype.handleFormSubmissionResponse=function(data){if(data.formerror){$(".ajaxForm").html(data.html),$("head").append(data.javascript);var self=this;$("."+this.nodeContent+" .mform").bind("submit",(function(e){e.preventDefault(),self.submitFormAjax(this)}))}else alert("Success!")},NewGroup.prototype.handleFormSubmissionFailure=function(data){},NewGroup.prototype.submitFormAjax=function(form){this.args.jsonformdata=$(form).serialize();var self=this;Ajax.call({args:this.args,url:this.url}).done((function(response){self.handleFormSubmissionResponse(response)})).fail((function(ex){}))},NewGroup.prototype.submitForm=function(e){e.preventDefault(),this.modal.getRoot().find("form").submit()},{init:function(args){return new NewGroup(args,url)}}}));

//# sourceMappingURL=newgroup.min.js.map