{"version":3,"file":"report.min.js","sources":["../src/report.js"],"sourcesContent":["/**\n * Standard Report wrapper for Moodle. It calls the central JS file for Report plugin,\n * Also it includes JS libraries like Select2,Datatables and Highcharts\n * @module     block_learnerscript/report\n * @class      report\n * @package    block_learnerscript\n * @copyright  2017 Naveen kumar <naveen@eabyas.in>\n * @since      3.3\n */\ndefine(['block_learnerscript/select2',\n    'block_learnerscript/responsive.bootstrap',\n    'block_learnerscript/reportwidget',\n    'block_learnerscript/chart',\n    'block_learnerscript/smartfilter',\n    'block_learnerscript/helper',\n    'block_learnerscript/ajaxforms',\n    'jquery',\n    'block_learnerscript/radioslider',\n    'block_learnerscript/flatpickr',\n    'core/templates',\n    'jqueryui'\n], function(select2, DataTable, reportwidget, chart, smartfilter, helper, AjaxForms,\n    $, RadiosToSlider, flatpickr, templates) {\n    var report;\n    var BasicparamCourse = $('.basicparamsform #id_filter_course');\n    var BasicparamUsers = $('.basicparamsform #id_filter_users');\n    var BasicparamUser = $('.basicparamsform #id_filter_user');\n    var BasicparamActivity = $('.basicparamsform #id_filter_activities'); \n    var BasicparamOrganization = $('.basicparamsform #id_filter_organization'); \n    var BasicparamDepartments = $('.basicparamsform #id_filter_departments'); \n    var BasicparamSubdepartments = $('.basicparamsform #id_filter_subdepartments');\n    var Basicparaml4departments = $('.basicparamsform #id_filter_level4department');\n    var Basicparaml5departments = $('.basicparamsform #id_filter_level5department');\n    var BasicparamLearningpath = $('.basicparamsform #id_filter_learningpath'); \n    var BasicparamOnlinecourses = $('.basicparamsform #id_filter_onlinecourses'); \n    var BasicparamLabs = $('.basicparamsform #id_filter_labs'); \n    var BasicparamAssessments = $('.basicparamsform #id_filter_assessments');\n    var BasicparamUsersgroups = $('.basicparamsform #id_filter_usergroup');\n    var BasicparamWebinars = $('.basicparamsform #id_filter_webinars'); \n    var BasicparamClassrooms = $('.basicparamsform #id_filter_classrooms'); \n    var BasicparamPrograms = $('.basicparamsform #id_filter_programs');     \n    var BasicparamCohort = $('.basicparamsform #id_filter_cohort');\n    var BasicparamGeostate = $('.basicparamsform #id_filter_geostate');\n    var BasicparamGeodistrict = $('.basicparamsform #id_filter_geodistrict');\n    var BasicparamGeosubdistrict = $('.basicparamsform #id_filter_geosubdistrict');\n    var BasicparamGeovillage = $('.basicparamsform #id_filter_geovillage');\n\n    var FilterCourse = $('.filterform #id_filter_course');\n    var FilterUsers = $('.filterform #id_filter_users');\n    var FilterUser = $('.filterform #id_filter_user');\n    var FilterActivity = $('.filterform #id_filter_activities');\n    var FilterModule = $('.filterform #id_filter_modules');\n    var FilterOrganization = $('.filterform #id_filter_organization');\n    var FilterDepartments = $('.filterform #id_filter_departments');\n    var FilterSubdepartments = $('.filterform #id_filter_subdepartments');\n    var Filterl4departments = $('.filterform #id_filter_level4department');\n    var Filterl5departments = $('.filterform #id_filter_level5department');\n    var FilterLearningpath = $('.filterform #id_filter_learningpath');\n    var FilterOnlinecourses = $('.filterform #id_filter_onlinecourses');\n    var FilterLabs = $('.filterform #id_filter_labs');\n    var FilterAssessments = $('.filterform #id_filter_assessments');\n    var FilterUsersgroups = $('.filterform #id_filter_usergroup');\n    var FilterWebinars = $('.filterform #id_filter_webinars');\n    var FilterClassrooms = $('.filterform #id_filter_classrooms');\n    var FilterPrograms = $('.filterform #id_filter_programs');\n    var FilterCohort = $('.filterform #id_filter_cohort');\n    var FilterGeostate = $('.filterform #id_filter_geostate');\n    var FilterGeodistrict = $('.filterform #id_filter_geodistrict');\n    var FilterGeosubdistrict = $('.filterform #id_filter_geosubdistrict');\n    var FilterGeovillage = $('.filterform #id_filter_geovillage');\n\n    var NumberOfBasicParams = 0;\n\n    return report = {\n        init: function(args) {\n            /**\n             * Initialization\n             */\n            $.ui.dialog.prototype._focusTabbable = $.noop;\n            $.fn.dataTable.ext.errMode = 'none';\n\n            $('.plotgraphcontainer').on('click', function() {\n                var reportid = $(this).data('reportid');\n                // $(this).removeClass('show').addClass('show');\n                $('.plotgraphcontainer').removeClass('show').addClass('hide');\n                $('#plotreportcontainer' + reportid).html('');\n\n            })\n            /**\n             * Select2 initialization\n             */\n            $(\"select[data-select2='1']\").select2({\n                theme: \"classic\"\n            }).on(\"select2:selecting\", function(e) {\n                if ($(this).val() && $(this).data('maximumSelectionLength') &&\n                    $(this).val().length >= $(this).data('maximumSelectionLength')) {\n                    e.preventDefault();\n                    $(this).select2('close');\n                }\n            });\n\n            /*\n             * Report search\n             */\n            $(\"#reportsearch\").val(args.reportid).trigger('change.select2');\n            $(\"#reportsearch\").change(function() {\n                var reportid = $(this).find(\":selected\").val();\n                window.location = M.cfg.wwwroot + '/blocks/learnerscript/viewreport.php?id=' + reportid;\n            });\n            /**\n             * Duration buttons\n             */\n            RadiosToSlider.init($('#segmented-button'), {\n                size: 'medium',\n                animation: true,\n                reportdashboard: false\n            });\n            /**\n             * Duration Filter\n             */\n            flatpickr('#customrange', {\n                mode: 'range',\n                onOpen: function(selectedDates, dateStr,instance){\n                    instance.clear();\n                },\n                onClose: function(selectedDates, dateStr, instance) {\n                    if(selectedDates.length !== 0){\n                        $('#ls_fstartdate').val(selectedDates[0].getTime() / 1000);\n                        $('#ls_fenddate').val((selectedDates[1].getTime() / 1000) + (60 * 60 * 24));\n                        require(['block_learnerscript/report'], function(report) {\n                            report.CreateReportPage({ reportid: args.reportid, instanceid: args.reportid, reportdashboard: false });\n                        });\n                    }\n                }\n            });\n\n            /*\n             * Get Activities and Enrolled users for selected course\n             */\n            if (typeof BasicparamCourse != 'undefined' || typeof FilterCourse != 'undefined') {\n                $('#id_filter_course').change(function() {\n                    args.courseid = $(this).find(\":selected\").val();\n                    smartfilter.CourseData(args);\n                });\n            }\n\n            /*\n             * Get Enrolled courses for selected user\n             */\n            $('#id_filter_users').change(function() {\n                var userid = $(this).find(\":selected\").val();\n                if (userid > 0 && (FilterCourse.length > 0 || BasicparamCourse.length > 0)) {\n                    if(BasicparamUsers.length > 0){\n                   // FirstElementActive = true;\n                    smartfilter.UserCourses({ userid: userid, reporttype: args.reporttype, reportid: args.reportid, \n                                              firstelementactive: FirstElementActive, triggercourseactivities: true });\n\n                 }\n                }\n            }); \n\n            /*\n             * Get Departments for selected Organization\n             */\n            $('#id_filter_organization').change(function() {\n                var organizationid = $(this).find(\":selected\").val();\n                if(organizationid > 0){\n                    if ((FilterDepartments.length > 0 || BasicparamDepartments.length > 0)) {\n                        if(BasicparamDepartments.length > 0){\n                            FirstElementActive = true;\n                        }\n                        var departmentid = args.filterrequests.filter_departments;\n                        smartfilter.orgdepartments({ organizationid: organizationid, reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid });\n                    }\n                    if ((FilterLearningpath.length > 0 || BasicparamLearningpath.length > 0)) {\n                        if(BasicparamLearningpath.length > 0){\n                            FirstElementActive = true;\n                        }\n                        var departmentid = args.filterrequests.filter_departments;\n                        smartfilter.orglearningpath({ organizationid: organizationid, reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid });\n                    }\n                    if (FilterUser.length > 0 || BasicparamUser.length > 0) {\n                        if(BasicparamUser.length > 0){\n                            FirstElementActive = true;\n                        }\n                        smartfilter.DepartmentUser({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                    }\n                    if (FilterGeostate.length > 0 || BasicparamGeostate.length > 0) {\n                        if(BasicparamGeostate.length > 0){\n                            FirstElementActive = true;\n                        }\n                        smartfilter.GeoState({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                    }\n                }\n            }); \n            $('#id_filter_geostate').change(function() {\n                var geostate = $(this).find(\":selected\").val();\n                if (FilterGeodistrict.length > 0 || BasicparamGeodistrict.length > 0) {\n                    if(BasicparamGeodistrict.length > 0){\n                        FirstElementActive = true;\n                    }\n                    smartfilter.GeoDistrict({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                }\n            });\n            $('#id_filter_geodistrict').change(function() {\n                var geostate = $(this).find(\":selected\").val();\n                if (FilterGeosubdistrict.length > 0 || BasicparamGeosubdistrict.length > 0) {\n                    if(BasicparamGeosubdistrict.length > 0){\n                        FirstElementActive = true;\n                    }\n                    smartfilter.GeoSubdistrict({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                }\n            });\n            $('#id_filter_geosubdistrict').change(function() {\n                var geostate = $(this).find(\":selected\").val();\n                if (FilterGeovillage.length > 0 || BasicparamGeovillage.length > 0) {\n                    if(BasicparamGeovillage.length > 0){\n                        FirstElementActive = true;\n                    }\n                    smartfilter.GeoVillage({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                }\n            });\n            $('#id_filter_departments').change(function() { \n                var departmentid = $(this).find(\":selected\").val();\n                var organizationid = $('#id_filter_organization').find(\":selected\").val(); \n                if ((FilterSubdepartments.length > 0 || BasicparamSubdepartments.length > 0)) {\n                    if(BasicparamSubdepartments.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.DepartmentSubdepts({ organizationid: organizationid, departmentid: departmentid, reporttype: args.reporttype, firstelementactive: FirstElementActive, subdepartmentid: subdepartmentid });\n                }\n                if ((FilterCohort.length > 0 || BasicparamCohort.length > 0)) {\n                    if(BasicparamCohort.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var cohortid = args.filterrequests.filter_cohort;\n                    smartfilter.DepartmentCohorts({ organizationid: organizationid, departmentid: departmentid, reporttype: args.reporttype, firstelementactive: FirstElementActive, cohortid: cohortid });\n                }\n                if (FilterUser.length > 0 || BasicparamUser.length > 0) {\n                    if(BasicparamUser.length > 0){\n                        FirstElementActive = true;\n                    }\n                    smartfilter.DepartmentUser({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                }\n            }); \n\n            $('#id_filter_subdepartments').change(function() { \n                var subdepartmentid = $(this).find(\":selected\").val();\n                var departmentid = $('#id_filter_departments').find(\":selected\").val();\n                var organizationid = $('#id_filter_organization').find(\":selected\").val(); \n                // if (FilterUsers.length > 0 && args.basicparams) {\n                //     if (args.basicparams.length == 3 && args.basicparams[2].name == 'course') {\n                //         // return false;\n                //     }\n                // } else { \n                    // if (BasicparamUsers.length > 0) {\n                        if ((FilterUsers.length > 0 || BasicparamUsers.length > 0)) {\n                            if(BasicparamUsers.length > 0){\n                                FirstElementActive = true;\n                            }\n                            var userid = args.filterrequests.filter_users;\n                            smartfilter.DepartmentUsers({ organizationid: organizationid, departmentid: departmentid, subdepartmentid: subdepartmentid, reporttype: args.reporttype, firstelementactive: FirstElementActive, userid: userid });\n                        }\n                        if ((FilterUser.length > 0 || BasicparamUser.length > 0)) {\n                            if(BasicparamUser.length > 0){\n                                FirstElementActive = true;\n                            }\n                            smartfilter.DepartmentUser({ organizationid: organizationid, departmentid: departmentid, subdepartmentid: subdepartmentid, reporttype: args.reporttype, firstelementactive: FirstElementActive, userid: userid });\n                        }\n                    // }\n                // }\n                // if (FilterCourse.length > 0 && args.basicparams){\n                //     if (args.basicparams.length == 3 && args.basicparams[2].name == 'users') {\n                //         // return false;\n                //     }\n                // } else {\n                    if (BasicparamCourse.length > 0 || FilterCourse.length > 0) {\n                        if ((FilterCourse.length > 0 || BasicparamCourse.length > 0)) {\n                            if(BasicparamCourse.length > 0){\n                                FirstElementActive = true;\n                            }\n                            var courseid = args.filterrequests.filter_course; \n                            smartfilter.DepartmentCourses({ organizationid: organizationid, departmentid: departmentid, subdepartmentid: subdepartmentid,reporttype: args.reporttype, firstelementactive: FirstElementActive, courseid: courseid });\n                        }\n                    }\n                // } \n                if ((Filterl4departments.length > 0 || Basicparaml4departments.length > 0)) {\n                    if(Basicparaml4departments.length > 0){\n                        FirstElementActive = true;\n                    }\n                    smartfilter.Departmentl4depts({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                }\n                if ((FilterLearningpath.length > 0 || BasicparamLearningpath.length > 0)) {\n                    if(BasicparamLearningpath.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.deplearningpath({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid});\n                }\n                if ((FilterOnlinecourses.length > 0 || BasicparamOnlinecourses.length > 0)) {\n                    if(BasicparamOnlinecourses.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.deponlinecourses({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid });\n                }\n                if ((FilterLabs.length > 0 || BasicparamLabs.length > 0)) {\n                    if(BasicparamLabs.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.deplabs({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid });\n                }\n                if ((FilterAssessments.length > 0 || BasicparamAssessments.length > 0)) {\n                    if(BasicparamAssessments.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.depassessments({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid });\n                }\n                if ((FilterUsersgroups.length > 0 || BasicparamUsersgroups.length > 0)) {\n                    if(BasicparamUsersgroups.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.depusergroups({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid });\n                }                \n                if ((FilterWebinars.length > 0 || BasicparamWebinars.length > 0)) {\n                    if(BasicparamWebinars.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.depwebinars({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid });\n                }\n                if ((FilterClassrooms.length > 0 || BasicparamClassrooms.length > 0)) {\n                    if(BasicparamClassrooms.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.depclassrooms({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid });\n                }\n                if ((FilterPrograms.length > 0 || BasicparamPrograms.length > 0)) {\n                    if(BasicparamPrograms.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var departmentid = args.filterrequests.filter_departments;\n                    var subdepartmentid = args.filterrequests.filter_subdepartments;\n                    smartfilter.depprograms({reporttype: args.reporttype, firstelementactive: FirstElementActive, departmentid: departmentid, subdepartmentid: subdepartmentid });\n                }                \n            });\n\n            $('#id_filter_level4department').change(function() {\n                var l4departmentid = $(this).find(\":selected\").val();\n                var subdepartmentid = $('#id_filter_subdepartments').find(\":selected\").val();\n                var departmentid = $('#id_filter_departments').find(\":selected\").val();\n                var organizationid = $('#id_filter_organization').find(\":selected\").val();\n\n                if ((FilterUsers.length > 0 || BasicparamUsers.length > 0)) {\n                    if(BasicparamUsers.length > 0){\n                        FirstElementActive = true;\n                    }\n                    var userid = args.filterrequests.filter_users;\n                    smartfilter.DepartmentUsers({ organizationid: organizationid, departmentid: departmentid, subdepartmentid: subdepartmentid, reporttype: args.reporttype, firstelementactive: FirstElementActive, userid: userid });\n                }\n                if ((Filterl5departments.length > 0 || Basicparaml5departments.length > 0)) {\n                    if(Basicparaml5departments.length > 0){\n                        FirstElementActive = true;\n                    }\n                    smartfilter.Departmentl5depts({reporttype: args.reporttype, firstelementactive: FirstElementActive});\n                }\n            });\n\n            $('#id_filter_coursecategories').change(function() {\n                var categoryid = $(this).find(\":selected\").val();\n                smartfilter.categoryCourses({ categoryid: categoryid, reporttype: args.reporttype });\n            });\n\n            // $('#id_filter_organization').change(function() {\n            //     var orgid = $(this).find(\":selected\").val();\n            //     smartfilter.requieddependencies({ orgid: orgid, reporttype: args.reporttype, 'orgtype': 'org' });\n            // });\n\n            schedule.SelectRoleUsers();\n\n            if (args.basicparams != null) {\n                if (args.basicparams[0].name == 'course') {\n                    $(\"#id_filter_course\").trigger('change');\n                    NumberOfBasicParams++;\n                }\n            }\n            if (args.basicparams != null) {\n                var FirstElementActive = false;\n                if (args.basicparams[0].name == 'users') {\n                    if (BasicparamCourse.length > 0) {\n                        FirstElementActive = true;\n                    }\n                    var userid = $(\"#id_filter_users\").find(\":selected\").val();\n                    if (userid > 0) {\n                        //args.courseid = $(this).find(\":selected\").val();\n                        args.courseid = $('#id_filter_course').find(\":selected\").val();\n                        smartfilter.CourseData(args);\n                        // smartfilter.UserCourses({ userid: userid, reportid: args.reportid, reporttype: args.reporttype,\n                        //                           firstelementactive: FirstElementActive, triggercourseactivities: true });\n                    }\n                }\n            }\n\n            //For forms formatting..can't make unique everywhere, so little trick ;)\n            $('.filterform' + args.reportid + ' .fitemtitle').hide();\n            $('.filterform' + args.reportid + ' .felement').attr('style', 'margin:0');\n\n            $('.basicparamsform' + args.reportid + ' .fitemtitle').hide();\n            $('.basicparamsform' + args.reportid + ' .felement').attr('style', 'margin:0');\n\n            /*\n             * Filter form submission\n             */\n            $(\".filterform #id_filter_clear\").click(function(e) {\n                var NumberOfBasicParams = 0;\n                $(\".filterform\" + args.reportid).trigger(\"reset\");\n                var activityelement = $(this).parent().find('#id_filter_activities');\n                if (FilterUsers.length > 0) {\n                    if (FilterCourse.length > 0 || BasicparamCourse.length > 0) {\n                        if(BasicparamCourse.length > 0){\n                            FirstElementActive = true;\n                        }\n                        // smartfilter.UserCourses({ userid: 0, reportid: args.reportid, reporttype: args.reporttype, firstelementactive: FirstElementActive });\n                    }\n                    // $(\"select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\n                }\n                if (FilterCourse.length > 0) {\n                    if (FilterUsers.length > 0 || BasicparamUsers.length > 0) {\n                        // smartfilter.EnrolledUsers({ courseid: 0, reportid: args.reportid, reporttype: args.reporttype, components: args.components });\n                    }\n\n                    if (FilterActivity.length > 0 || BasicparamActivity.length > 0) {\n                        smartfilter.CourseActivities({ courseid: 0 });\n                    }\n                    // $(\"select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\n                }\n                if (FilterActivity.length > 0 || FilterModule.length > 0) {\n                    if ((FilterCourse.length > 0 || BasicparamCourse.length > 0) && BasicparamUsers.length == 0) {\n                        if(BasicparamCourse.length > 0 && BasicparamUsers.length == 0){\n                            FirstElementActive = true;\n                        }\n                        // smartfilter.UserCourses({ userid: 0, reportid: args.reportid, reporttype: args.reporttype, firstelementactive: FirstElementActive });\n                    }\n                    if (BasicparamCourse.length > 0 && BasicparamUsers.length > 0) {\n                            $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\n                    }\n                    // $(\"select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\n                }\n\n                if ($(\".basicparamsform #id_filter_apply\").length > 0) {\n                    $(document).ajaxComplete(function(event, xhr, settings) {\n                        // if (settings.url.indexOf(\"blocks/learnerscript/ajax.php\") > 0) {\n                        //     if (typeof settings.data != 'undefined') {\n                        //         var ajaxaction = $.parseJSON(settings.data);\n                        //         if (typeof ajaxaction.basicparam != 'undefined' && ajaxaction.basicparam == true) {\n                        //             NumberOfBasicParams++;\n                        //         }\n                        //     }\n                        //     if (args.basicparams.length == NumberOfBasicParams) {\n                        //         $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\n                        //     }\n                        // }\n                    });\n                    $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\n                } else {\n                    args.reporttype = $('.ls-plotgraphs_listitem.ui-tabs-active').data('cid');\n                    report.CreateReportPage({ reportid: args.reportid, reporttype: args.reporttype, instanceid: args.reportid });\n                }\n                $(\".filterform select[data-select2='1']\").select2(\"destroy\").select2({ theme: \"classic\" });\n                $(\".filterform select[data-select2-ajax='1']\").val('0').trigger('change');\n                $('.filterform')[0].reset();\n                $(\".filterform #id_filter_clear\").attr('disabled', 'disabled');\n                $('.plotgraphcontainer').removeClass('show').addClass('hide');\n                $('#plotreportcontainer' + args.instanceid).html('');\n            });\n\n            /*\n             * Basic parameters form submission\n             */\n            $(\".basicparamsform #id_filter_apply,.filterform #id_filter_apply\").click(function(e, validate) {\n                var getreport = helper.validatebasicform(validate);\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                $(\".filterform\" + args.reportid).show();\n                args.instanceid = args.reportid;\n                if(e.currentTarget.value != 'Get Report'){\n                    $(\".filterform #id_filter_clear\").removeAttr('disabled');\n                }\n                if ($.inArray(0, getreport) != -1) {\n                    $(\"#report_plottabs\").hide();\n                    $(\"#reportcontainer\" + args.reportid).html(\"<div class='alert alert-info'>No data available</div>\");\n                } else {\n                    $(\"#report_plottabs\").show();\n                    args.reporttype = $('.ls-plotgraphs_listitem.ui-tabs-active').data('cid');\n                    report.CreateReportPage({ reportid: args.reportid, reporttype: args.reporttype, instanceid: args.instanceid, reportdashboard: false });\n                }\n                $('.plotgraphcontainer').removeClass('show').addClass('hide');\n                $('#plotreportcontainer' + args.instanceid).html('');\n            });\n            /*\n             * Generate Plotgraph\n             */\n            if (args.basicparams == null) {\n                report.CreateReportPage({ reportid: args.reportid, reporttype: args.reporttype, instanceid: args.reportid, reportdashboard: false });\n            } else {\n                if (args.basicparams.length == 1 || args.basicparams.length == 2 || args.basicparams.length == 3 || args.basicparams.length == 4) {\n                    $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\n                } else {\n                        $(document).ajaxComplete(function(event, xhr, settings) {\n                            if (settings.url.indexOf(\"blocks/learnerscript/ajax.php\") > 0) {\n                                if (typeof settings.data != 'undefined') {\n                                    var ajaxaction = $.parseJSON(settings.data);\n                                    if (typeof ajaxaction.basicparam != 'undefined' && ajaxaction.basicparam == true) {\n                                        NumberOfBasicParams++;\n                                    }\n                                }\n                                if (args.basicparams.length == NumberOfBasicParams\n                                    && ajaxaction.action != 'plotforms' && ajaxaction.action != 'pluginlicence') {\n                                    $(\".basicparamsform #id_filter_apply\").trigger('click', [true]);\n                                }\n                            }\n                        });\n                }\n            }\n\n            /*\n             * Make sure will have vertical tabs for plotoptions for report\n             */\n            // $tabs = $('#report_plottabs').tabs().addClass(\"ui-tabs-vertical ui-helper-clearfix\");\n            // $(\"#report_plottabs li\").removeClass(\"ui-corner-top\").addClass(\"ui-corner-left\");\n\n            // helper.tabsdraggable($tabs);\n\n        },\n        CreateReportPage: function(args) {\n            var disabletable = 0;\n            if (args.reportdashboard == false) {\n                var disabletable = $('#disabletable').val();\n                if (disabletable) {\n                    args.reporttype = $($('.ls-plotgraphs_listitem')[0]).data('cid');\n                }\n            }\n            if (disabletable == 1 && args.reporttype.length > 0) {\n                chart.HighchartsAjax({\n                    'reportid': args.reportid,\n                    'action': 'generate_plotgraph',\n                    'cols': args.cols,\n                    'reporttype': args.reporttype\n                });\n            } else if (disabletable == 0) {\n                reportwidget.CreateDashboardwidget({\n                    reportid: args.reportid,\n                    reporttype: 'table',\n                    instanceid: args.reportid,\n                    reportdashboard: args.reportdashboard\n                });\n            } else {\n\n            }\n        },\n        /**\n         * Generates graph widget with given Highcharts ajax response\n         * @param  object response Ajax response\n         * @return Creates highchart widget with given response based on type of chart\n         */\n        generate_plotgraph: function(response) {\n            var returned;\n            response.containerid = 'plotreportcontainer' + response.reportinstance;\n            switch (response.type) {\n                case 'pie':\n                    chart.piechart(response);\n                    break;\n                case 'spline':\n                case 'bar':\n                case 'column':\n                    chart.lbchart(response);\n                    break;\n                case 'solidgauge':\n                    chart.solidgauge(response);\n                    break;\n                case 'combination':\n                    chart.combinationchart(response);\n                    break;\n                case 'map':\n                    chart.WorldMap(response);\n                    break;\n                case 'treemap':\n                    chart.TreeMap(response);\n                    break;\n            }\n        },\n        /**\n         * Datatable serverside for all table type reports\n         * @param object args reportid\n         * @return Apply serverside datatable to report table\n         */\n        ReportDatatable: function(args) {\n            var self = this;\n            var params = {};\n            var reportinstance = args.instanceid ? args.instanceid : args.reportid;\n            params['filters'] = args.filters;\n            params['basicparams'] = args.basicparams || JSON.stringify(smartfilter.BasicparamsData(reportinstance));\n            params['reportid'] = args.reportid;\n            params['columns'] = args.columns;\n            //\n            // Pipelining function for DataTables. To be used to the `ajax` option of DataTables\n            //\n            $.fn.dataTable.pipeline = function(opts) {\n                // Configuration options\n                var conf = $.extend({\n                    url: '', // script url\n                    data: null, // function or object with parameters to send to the server\n                    method: 'POST' // Ajax HTTP method\n                }, opts);\n\n                return function(request, drawCallback, settings) {\n                    var ajax = true;\n                    var requestStart = request.start;\n                    var drawStart = request.start;\n                    var requestLength = request.length;\n                    var requestEnd = requestStart + requestLength;\n\n                    if (typeof args.data != 'undefined' && request.draw == 1) {\n                        json = args.data;\n                        json.draw = request.draw; // Update the echo for each response\n                        json.data.splice(0, requestStart);\n                        json.data.splice(requestLength, json.data.length);\n                        drawCallback(json);\n                    } else if (ajax) {\n                        // Need data from the server\n                        request.start = requestStart;\n                        request.length = requestLength;\n                        $.extend(request, conf.data);\n\n                        settings.jqXHR = $.ajax({\n                            \"type\": conf.method,\n                            \"url\": conf.url,\n                            \"data\": request,\n                            \"dataType\": \"json\",\n                            \"cache\": false,\n                            \"success\": function(json) {\n                                drawCallback(json);\n                            }\n                        });\n                    } else {\n                        json = $.extend(true, {}, cacheLastJson);\n                        json.draw = request.draw; // Update the echo for each response\n                        json.data.splice(0, requestStart - cacheLower);\n                        json.data.splice(requestLength, json.data.length);\n                        drawCallback(json);\n                    }\n                }\n            };\n            if (args.reportname == 'Users profile' || args.reportname == 'Course profile') {\n                var lengthoptions = [\n                    [50, 100, -1],\n                    [\"Show 50\", \"Show 100\", \"Show All\"]\n                ];\n            } else {\n                var lengthoptions = [\n                    [10, 25, 50, 100, -1],\n                    [\"Show 10\", \"Show 25\", \"Show 50\", \"Show 100\", \"Show All\"]\n                ];\n            }\n            var oTable = $('#reporttable_' + reportinstance).DataTable({\n                'processing': true,\n                'serverSide': true,\n                'destroy': true,\n                'dom': '<\"co_report_header\"Bf <\"report_header_skew\"  <\"report_header_skew_content\" Bl<\"report_header_showhide\" ><\"report_calculation_showhide\" >> > > tr <\"co_report_footer\"ip>',\n                'ajax': $.fn.dataTable.pipeline({\n                    \"type\": \"POST\",\n                    \"url\": M.cfg.wwwroot + '/blocks/learnerscript/components/datatable/server_processing.php?sesskey=' + M.cfg.sesskey,\n                    \"data\": params\n                }),\n                'columnDefs': args.columnDefs,\n                \"fnDrawCallback\": function(oSettings, json) {\n                    chart.SparkLineReport();\n                    helper.DrilldownReport();\n                },\n                \"oScroll\": {},\n                'responsive': true,\n                \"fnInitComplete\": function() {\n                    this.fnAdjustColumnSizing(true);\n                    $(\".drilldown\" + reportinstance + \" .ui-dialog-title\").html(args.reportname);\n\n                    if (args.reportname == 'Users profile' || args.reportname == 'Course profile') {\n                        $(\"#reporttable_\" + reportinstance + \"_wrapper .co_report_header\").remove();\n                        $(\"#reporttable_\" + reportinstance + \"_wrapper .co_report_footer\").remove();\n                    }\n                    if (args.reportname == 'Learning') {\n                        $(\"#reporttable_\" + reportinstance + \"_wrapper .co_report_footer\").remove();\n                        $( \"#reporttable_\" + reportinstance + \"_filter\" ).hide();\n                    }\n                    $('.download_menu' + reportinstance + ' li a').each(function(index) {\n                        var link = $(this).attr('href');\n                        if (typeof args.basicparams != 'undefined') {\n                            var basicparamsdata = JSON.parse(args.basicparams);\n                            $.each(basicparamsdata, function(key, value) {\n                                if (key.indexOf('filter_') == 0) {\n                                    link += '&' + key + '=' + value;\n                                }\n                            });\n                        }\n                        if (typeof(args.filters) != 'undefined') {\n                            var filters = JSON.parse(args.filters);\n                            $.each(filters, function(key, value) {\n                                if (key.indexOf('filter_') == 0) {\n                                    link += '&' + key + '=' + value;\n                                }\n                                if(key.indexOf('ls_') == 0) {\n                                    link += '&' + key + '=' + value;\n                                }\n                            });\n                        }\n                        $(this).attr('href', link);\n                    });\n                },\n                \"fnRowCallback\": function(nRow, aData, iDisplayIndex) {\n                    $(nRow).children().each(function(index, td) {\n                        $(td).css(\"word-break\", args.columnDefs[index].wrap);\n                        $(td).css(\"width\", args.columnDefs[index].width);\n                    });\n                    return nRow;\n                },\n                \"autoWidth\": false,\n                'aaSorting': [],\n                'language': {\n                    'paginate': {\n                        'previous': '<',\n                        'next': '>'\n                    },\n                    'sProcessing': \"<img src='\" + M.util.image_url('loading', 'block_learnerscript') + \"'>\",\n                    'search': \"_INPUT_\",\n                    'searchPlaceholder': \"Search\",\n                    'lengthMenu': \"_MENU_\",\n                    \"emptyTable\": \"<div class='alert alert-info'>No data available</div>\"\n                },\n                \"lengthMenu\": lengthoptions\n            });\n            $(\"#page-blocks-learnerscript-viewreport #reporttable_\" + args.reportid + \"_wrapper div.report_header_showhide\").\n            html($('#export_options' + args.reportid).html());\n            if ($('.reportcalculation' + args.reportid).length > 0) {\n                $(\"#page-blocks-learnerscript-viewreport #reporttable_\" + args.reportid + \"_wrapper div.report_calculation_showhide\").\n                html('<img src=\"' + M.util.image_url('calculationicon', 'block_learnerscript') + '\" onclick=\"(function(e){ require(\\'block_learnerscript/helper\\').reportCalculations({reportid:' + args.reportid + '}) })(event)\" title =\"Calculations\" />');\n            }\n            // $('#export_options' + args.reportid).remove();\n        },\n        AddExpressions: function(e, value) {\n            $(e.target).on('select2:unselecting', function(e){\n                $('#fitem_id_'+e.params.args.data.id+'').remove();\n            });\n            var columns = $(e.target).val();\n            $.each(columns, function(index){\n                if($('#fitem_id_'+columns[index]).length > 0){\n                    return;\n                }\n                var column = [];\n                 column['name'] = columns[index];\n                 column.conditionsymbols = [];\n                 var conditions = [\"=\", \">\", \"<\", \">=\", \"<=\", \"<>\"];\n                 $.each(conditions, function(index, value){\n                    column.conditionsymbols.push({\n                        'value': value\n                    })\n                 });\n                var requestdata = { column: column };\n                templates.render('block_learnerscript/plotconditions', requestdata).then(function(html){\n                    //$(e.target).closest('form').find('#fitem_id_yaxis_bar').after(html);\n                    //$(e.target).closest('form').find('#fitem_id_yaxis').after(html);\n                    if(value == 'yaxisbarvalue') {\n                        $('#yaxis_bar1').append(html);\n                    } else {\n                        $('#yaxis1').append(html);\n                    }\n\n                }).fail(function(ex){});\n            });\n        }\n    };\n});\n"],"names":["define","select2","DataTable","reportwidget","chart","smartfilter","helper","AjaxForms","$","RadiosToSlider","flatpickr","templates","report","BasicparamCourse","BasicparamUsers","BasicparamUser","BasicparamActivity","BasicparamDepartments","BasicparamSubdepartments","Basicparaml4departments","Basicparaml5departments","BasicparamLearningpath","BasicparamOnlinecourses","BasicparamLabs","BasicparamAssessments","BasicparamUsersgroups","BasicparamWebinars","BasicparamClassrooms","BasicparamPrograms","BasicparamCohort","BasicparamGeostate","BasicparamGeodistrict","BasicparamGeosubdistrict","BasicparamGeovillage","FilterCourse","FilterUsers","FilterUser","FilterActivity","FilterModule","FilterDepartments","FilterSubdepartments","Filterl4departments","Filterl5departments","FilterLearningpath","FilterOnlinecourses","FilterLabs","FilterAssessments","FilterUsersgroups","FilterWebinars","FilterClassrooms","FilterPrograms","FilterCohort","FilterGeostate","FilterGeodistrict","FilterGeosubdistrict","FilterGeovillage","NumberOfBasicParams","init","args","ui","dialog","prototype","_focusTabbable","noop","fn","dataTable","ext","errMode","on","reportid","this","data","removeClass","addClass","html","theme","e","val","length","preventDefault","trigger","change","find","window","location","M","cfg","wwwroot","size","animation","reportdashboard","mode","onOpen","selectedDates","dateStr","instance","clear","onClose","getTime","require","CreateReportPage","instanceid","courseid","CourseData","userid","UserCourses","reporttype","firstelementactive","FirstElementActive","triggercourseactivities","organizationid","departmentid","filterrequests","filter_departments","orgdepartments","orglearningpath","DepartmentUser","GeoState","GeoDistrict","GeoSubdistrict","GeoVillage","subdepartmentid","filter_subdepartments","DepartmentSubdepts","cohortid","filter_cohort","DepartmentCohorts","filter_users","DepartmentUsers","filter_course","DepartmentCourses","Departmentl4depts","deplearningpath","deponlinecourses","deplabs","depassessments","depusergroups","depwebinars","depclassrooms","depprograms","Departmentl5depts","categoryid","categoryCourses","schedule","SelectRoleUsers","basicparams","name","hide","attr","click","parent","CourseActivities","document","ajaxComplete","event","xhr","settings","reset","validate","getreport","validatebasicform","stopImmediatePropagation","show","currentTarget","value","removeAttr","inArray","url","indexOf","ajaxaction","parseJSON","basicparam","action","disabletable","HighchartsAjax","cols","CreateDashboardwidget","generate_plotgraph","response","containerid","reportinstance","type","piechart","lbchart","solidgauge","combinationchart","WorldMap","TreeMap","ReportDatatable","params","filters","JSON","stringify","BasicparamsData","columns","pipeline","opts","conf","extend","method","request","drawCallback","requestStart","start","requestLength","draw","json","splice","jqXHR","ajax","reportname","lengthoptions","sesskey","columnDefs","oSettings","SparkLineReport","DrilldownReport","fnAdjustColumnSizing","remove","each","index","link","basicparamsdata","parse","key","nRow","aData","iDisplayIndex","children","td","css","wrap","width","util","image_url","AddExpressions","target","id","column","conditionsymbols","push","requestdata","render","then","append","fail","ex"],"mappings":"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"}